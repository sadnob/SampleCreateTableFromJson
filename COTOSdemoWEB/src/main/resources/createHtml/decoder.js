var sample1 = {"createdAt":1513671829193,"createdUser":"aaa","updatedAt":1513671793386,"updatedUser":"sid","deletedAt":1513671829193,"deletedUser":"aaa","version":11,"id":10,"estimateNumber":"CE2017120600010-01","estimationTitle":"aaa","status":"作成中","totalPrice":11111,"usageBasedPrice":22222,"startDate":1513671829193,"orderDate":1513671829193,"latestActiveDate":1513671829193,"serviceStartMonth":1513671829193,"rlAutoTransferInfo":"aaa","salesClaimState":"aaa","customer":{"createdAt":1513673292973,"createdUser":"sid","updatedAt":1513672209170,"updatedUser":"sid","deletedAt":1513672209170,"deletedUser":"sid","version":0,"id":18460,"customerMaster":{"mclMomRelId":"1","mclMomKjbId":"1001","mclHanshCd":null,"mclUpdtDt":null,"mclBtPrcsAsofDt":null,"mclBtPrcsDt":null,"mclDltFlg":null,"mclUpdtUserId":null,"mclTntoshId":null,"mclCrtSysCd":null,"prflMomCstId":null,"prflMomKgyId":"1002","prflMomJgsId":"1003","prflMomBmnId":"1004","prflNyoOyaMomCstId":null,"prflKjbSetKbn":"企事","prflDltFlg":null,"prflScWebCrtDt":null,"prflScWebCrtUserId":null,"prflScWebCrtHanshCd":null,"prflScWebCrtKinoCd":null,"prflScWebUpdtDt":null,"prflScWebUpdtUserId":null,"prflScWebUpdtHanshCd":null,"prflScWebUpdtKinoCd":null,"prflScBtCrtKinoCd":null,"prflScBtCrtAsofDt":null,"prflScBtCrtDt":null,"prflScBtUpdtKinoCd":null,"prflScBtUpdtAsofDt":null,"prflScBtUpdtDt":null,"prflScSysKnrDt":null,"prflScSysKnrNo":null,"prflScMomUpdtKinoCd":null,"prflScMomUpdtDtTm":null,"kgyKgyNmKnji":"川崎工業株式会社","kgyKgyNmKana":null,"kgyHjnKakuCd":null,"kgyHjnKakuZengoCd":null,"kgyKgyPostNum":null,"kgyKgyAdsCd":"kawasakishi","kgyKgyAdsAzatusyoNm":null,"kgyKgyAdsBantiNm":null,"kgyKgyAdsGoNm":null,"kgyKgyAdsBldgNm":null,"kgyKgyAdsFlorNm":null,"kgyKgyTelNum":null,"kgyKgyFaxNum":null,"kgyKgyHpUrl":null,"kgyKgyGyshCd":null,"kgyKgyJgyinKboCd":null,"kgyKgyJgyinQty":100,"kgyKgyDhyshNmKnji":null,"kgyKgyDhyshYksykNmKnji":null,"kgyKgyNumCsmsCd":null,"kgyKgySplNm1":null,"kgyKgySplNm2":null,"kgyKgyShnkn":null,"kgyKgySirsk":null,"kgyKgyHnbisk":null,"kgyKgyJgsQty":null,"kgyKgyTousanHeisaInfoKbn":null,"kgyStrtsYearMs":null,"kgyKsnkiMs":null,"kgyNyoKgyNmKnji":null,"kgyNyoKgyNmKana":null,"kgyNyoKgySplNm1":null,"kgyNyoKgySplNm2":null,"kgyYoshinLimit":null,"kgyMknKokykSkbtKbn":null,"kgyMaTishFlg":null,"kgyNyoOyaMomKgyId":null,"kgyKgyMomKokykFlg":null,"kgyDltFlg":null,"kgyScWebCrtDt":null,"kgyScWebCrtUserId":null,"kgyScWebCrtHanshCd":null,"kgyScWebCrtKinoCd":null,"kgyScWebUpdtDt":null,"kgyScWebUpdtUserId":null,"kgyScWebUpdtHanshCd":null,"kgyScWebUpdtKinoCd":null,"kgyScBtCrtKinoCd":null,"kgyScBtCrtAsofDt":null,"kgyScBtCrtDt":null,"kgyScBtUpdtKinoCd":null,"kgyScBtUpdtAsofDt":null,"kgyScBtUpdtDt":null,"kgyScSysKnrDt":null,"kgyScSysKnrNo":null,"kgyScMomUpdtKinoCd":null,"kgyScMomUpdtDtTm":null,"kgyCuicHjnKaku":null,"kgyCuicGyshKgy":null,"kgyCuicClnMaeKgyKnji":null,"kgyCuicClnMaeKgyKana":null,"kgyCuicClnMaePostNum":null,"kgyCuicClnMaeAds":null,"kgyCuicAds":null,"kgyCuicBantiNum":null,"kgyCuicGoNum":null,"kgyCuicAdsErrFlg":null,"kgyCuicClnMaeTelNum":null,"kgyCuicClnMaeFaxNum":null,"kgyCuicJgyinKboKgy":null,"kgyCuicJgyshTikkCd":null,"kgyCuicHanshCd":null,"kgyCuicUpdtTntoshCd":null,"kgyCuicUpdtTermCd":null,"kgyCuicMcdbUpdtDt":null,"kgyCuicCrtSysCd":null,"kgyCuicUpdtSysCd":null,"kgyCuicMotoSysCrtdDt":null,"kgyCuicMotoSysUpdtDt":null,"kgyCuicBtPrcsAsofDt":null,"kgyCuicBtPrcsDt":null,"kgyCuicMcdbDltFlg":null,"kgyCuicUpdtTntoshHanshCd":null,"kgyCuicMcdbCrtdMtd":null,"kgyCuicMcdbUpdtMtd":null,"kgyCuicMcdbCrtdDt":null,"kgyCuicUpdtUserId":null,"kgySijosoCd":null,"kgyMomKishId":null,"kgyLbcCd":null,"kgyCorporateNumber":null,"adsKadsPostNum":null,"adsKtdhknNmKnji":null,"adsKskugnchosnKnji":null,"adsKowaTusyoKnji":null,"adsKkowChomeKnji":null,"adsKtdhknNmKana":null,"adsKskugnchosnKana":null,"adsKowaTusyoKana":null,"adsKowChomeKana":null,"adsKadsCdL":null,"adsKadsCdLm":null,"adsKadsCdLms":null,"adsKdltFlg":null,"adsKscWebCrtDt":null,"adsKscWebCrtUserId":null,"adsKscWebCrtHanshCd":null,"adsKscWebCrtKinoCd":null,"adsKscWebUpdtDt":null,"adsKscWebUpdtUserId":null,"adsKscWebUpdtHanshCd":null,"adsKscWebUpdtKinoCd":null,"adsKscBtCrtKinoCd":null,"adsKscBtCrtAsofDt":null,"adsKscBtCrtDt":null,"adsKscBtUpdtKinoCd":null,"adsKscBtUpdtAsofDt":null,"adsKscBtUpdtDt":null,"adsKscSysKnrDt":null,"adsKscSysKnrNo":null,"adsKscMomUpdtKinoCd":null,"adsKscMomUpdtDtTm":null,"adsKpostNumInfo1":null,"adsKpostNumInfo2":null,"adsKtourokuYearMs":null,"adsKhenkouYearMs":null,"adsKkoushinKbn":null,"gyshKgyshNmKnji":null,"gyshKgyshNmKana":null,"gyshKdltFlg":null,"gyshKscWebCrtDt":null,"gyshKscWebCrtUserId":null,"gyshKscWebCrtHanshCd":null,"gyshKscWebCrtKinoCd":null,"gyshKscWebUpdtDt":null,"gyshKscWebUpdtUserId":null,"gyshKscWebUpdtHanshCd":null,"gyshKscWebUpdtKinoCd":null,"gyshKscBtCrtKinoCd":null,"gyshKscBtCrtAsofDt":null,"gyshKscBtCrtDt":null,"gyshKscBtUpdtKinoCd":null,"gyshKscBtUpdtAsofDt":null,"gyshKscBtUpdtDt":null,"gyshKscSysKnrDt":null,"gyshKscSysKnrNo":null,"gyshKscMomUpdtKinoCd":null,"gyshKscMomUpdtDtTm":null,"jgsJgsNmKnji":"川崎事業所","jgsJgsNmKana":null,"jgsJgsPostNum":"111-1111","jgsJgsAdsCd":null,"jgsJgsAdsAzatusyoNm":"神奈川県川崎市XX区XX町XX丁目","jgsJgsAdsBantiNm":"XX番地","jgsJgsAdsGoNm":"XX号","jgsJgsAdsBldgNm":"XXビル","jgsJgsAdsFlorNm":"XX階","jgsJgsGyshCd":"販売","jgsJgsJgyinKboCd":null,"jgsJgsJgyinQty":5,"jgsKgyNumCsmsCd":null,"jgsJgsNumCsmsCd":null,"jgsJtnJgsCd":null,"jgsSijoBunrui1Cd":null,"jgsSijoBunrui2Cd":null,"jgsShrykShhnKnji":null,"jgsSysInfnStgCd":null,"jgsPpcInfnStg":null,"jgsJgsInfoKbn":null,"jgsJgsGyomNmKnji":null,"jgsJgsGrpwareCd":null,"jgsNyoJgsNmKnji":null,"jgsNyoJgsNmKana":null,"jgsNyoOyaMomJgsId":null,"jgsJgsTelNum":"111-1111-1111","jgsJgsFaxNum":null,"jgsJgsMomKokykFlg":null,"jgsDmcTntoCstFlg":null,"jgsDltFlg":null,"jgsScWebCrtDt":null,"jgsScWebCrtUserId":null,"jgsScWebCrtHanshCd":null,"jgsScWebCrtKinoCd":null,"jgsScWebUpdtDt":null,"jgsScWebUpdtUserId":null,"jgsScWebUpdtHanshCd":null,"jgsScWebUpdtKinoCd":null,"jgsScBtCrtKinoCd":null,"jgsScBtCrtAsofDt":null,"jgsScBtCrtDt":null,"jgsScBtUpdtKinoCd":null,"jgsScBtUpdtAsofDt":null,"jgsScBtUpdtDt":null,"jgsScSysKnrDt":null,"jgsScSysKnrNo":null,"jgsScMomUpdtKinoCd":null,"jgsScMomUpdtDtTm":null,"jgsSijosoCd":null,"jgsCstKnkrykCd":"A","jgsLbcCd":null,"adsJadsPostNum":null,"adsJtdhknNmKnji":null,"adsJskugnchosnKnji":null,"adsJowaTusyoKnji":null,"adsJkowChomeKnji":null,"adsJtdhknNmKana":null,"adsJskugnchosnKana":null,"adsJowaTusyoKana":null,"adsJkowChomeKana":null,"adsJadsCdL":null,"adsJadsCdLm":null,"adsJadsCdLms":null,"adsJdltFlg":null,"adsJscWebCrtDt":null,"adsJscWebCrtUserId":null,"adsJscWebCrtHanshCd":null,"adsJscWebCrtKinoCd":null,"adsJscWebUpdtDt":null,"adsJscWebUpdtUserId":null,"adsJscWebUpdtHanshCd":null,"adsJscWebUpdtKinoCd":null,"adsJscBtCrtKinoCd":null,"adsJscBtCrtAsofDt":null,"adsJscBtCrtDt":null,"adsJscBtUpdtKinoCd":null,"adsJscBtUpdtAsofDt":null,"adsJscBtUpdtDt":null,"adsJscSysKnrDt":null,"adsJscSysKnrNo":null,"adsJscMomUpdtKinoCd":null,"adsJscMomUpdtDtTm":null,"adsJpostNumInfo1":null,"adsJpostNumInfo2":null,"adsJtourokuYearMs":null,"adsJhenkouYearMs":null,"adsJkoushinKbn":null,"gyshJgyshNmKnji":null,"gyshJgyshNmKana":null,"gyshJdltFlg":null,"gyshJscWebCrtDt":null,"gyshJscWebCrtUserId":null,"gyshJscWebCrtHanshCd":null,"gyshJscWebCrtKinoCd":null,"gyshJscWebUpdtDt":null,"gyshJscWebUpdtUserId":null,"gyshJscWebUpdtHanshCd":null,"gyshJscWebUpdtKinoCd":null,"gyshJscBtCrtKinoCd":null,"gyshJscBtCrtAsofDt":null,"gyshJscBtCrtDt":null,"gyshJscBtUpdtKinoCd":null,"gyshJscBtUpdtAsofDt":null,"gyshJscBtUpdtDt":null,"gyshJscSysKnrDt":null,"gyshJscSysKnrNo":null,"gyshJscMomUpdtKinoCd":null,"gyshJscMomUpdtDtTm":null,"bmnBmnNmKnji":null,"bmnBmnNmKana":null,"bmnMomKgyId":null,"bmnBmnTelNum":"XXX-XXXX-XXXX","bmnBmnFaxNum":null,"bmnOyaMomBmnId":null,"bmnBmnSplNm1":null,"bmnBmnSplNm2":null,"bmnNyoBmnNmKnji":null,"bmnNyoBmnNmKana":null,"bmnNyoBmnSplNm1":null,"bmnNyoBmnSplNm2":null,"bmnNyoOyaMomBmnId":null,"bmnDltFlg":null,"bmnScWebCrtDt":null,"bmnScWebCrtUserId":null,"bmnScWebCrtHanshCd":null,"bmnScWebCrtKinoCd":null,"bmnScWebUpdtDt":null,"bmnScWebUpdtUserId":null,"bmnScWebUpdtHanshCd":null,"bmnScWebUpdtKinoCd":null,"bmnScBtCrtKinoCd":null,"bmnScBtCrtAsofDt":null,"bmnScBtCrtDt":null,"bmnScBtUpdtKinoCd":null,"bmnScBtUpdtAsofDt":null,"bmnScBtUpdtDt":null,"bmnScSysKnrDt":null,"bmnScSysKnrNo":null,"bmnScMomUpdtKinoCd":null,"bmnScMomUpdtDtTm":null,"bmnKgeigySgmtKbn":null,"bmnBmnShubtKbn":null,"valueKsyoSeg":null,"valueSsnSeg":"1","valueKsyoValue":null,"valueSsnValue":"1","valueShkeiYearMs":null,"valuePrcsDt":null,"valueSenkKsyoSeg":null,"valueSenkKsyoValue":null,"valueSegUpdtYm":null,"valueValueUpdtYm":null},"departmentDiv":"企事","companyId":"1002","officeId":"1003","officeName":"川崎事業所","departmentId":"1001","customerName":"川崎工業株式会社川崎事業所","phoneNumber":"111-1111-1111","postNumber":"111-1111","address":"神奈川県川崎市XX区XX町XX丁目XX番地XX号XX号XX階","businessTypeCd":"販売","businessType":null,"segment":"1","paramValues":"1","customerRelationship":"A","empNumCompany":100,"empNumOffice":5},"sales":{"createdAt":1513673292974,"createdUser":"sid","updatedAt":1513672209170,"updatedUser":"sid","deletedAt":1513672209170,"deletedUser":"sid","version":0,"id":18460,"salesMaster":{"id":1,"companyId":111111,"officeId":111111,"departmentId":111111,"salesName":"川崎店","phoneNumber":"111-1111-1111","postNumber":"111-1111","address":"神奈川県川崎市","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"companyId":1786354,"officeId":35654825,"departmentId":2674561,"salesName":"川崎店","phoneNumber":"000-1111-1111","postNumber":"111-1111","address":"神奈川県川崎市"},"employee":{"createdAt":1513673292974,"createdUser":"sid","updatedAt":1513672209170,"updatedUser":"sid","deletedAt":1513672209170,"deletedUser":"sid","version":0,"id":24902,"name":"担当　太郎","saCode":"SA001","ceName":"CE太郎","ceCode":"CE001","phoneNumber":"000-1111-1111","address":"神奈川県川崎市","faxNumber":"111-1111","postNumber":"111-1111","mailAddress":"aaa@ricoh.com","salesCompany":"川崎支店","affiliationName":"川崎事業所","departmentName":"第一営業部","supervisor":null,"employeeMaster":{"id":3,"name":"担当　太郎","saCode":"SA0001","phoneNumber":null,"address":null,"faxNumber":null,"postNumber":null,"mailAddress":null,"salesCompany":null,"affiliationName":null,"departmentName":null,"supervisorId":1,"department":{"id":1,"name":"川崎事業所","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"department":{"id":1,"name":"川崎事業所","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"attachedFiles":[]},"employeeJihon":"aaa","employeeHonbu":"aaa","addEditor":"aaa","invoiceRemarks":"aaa","invoiceFlag":true,"creditRemarks":"aaa","creditFlag":true,"sqmRemarks":"aaa","sqmFlag":true,"otherRemarks":"aaa","otherFlag":true,"estimationRemarks":"aaa","contractRemarks":"aaa","sqmResultRemarks":"aaa","estimationApproval":null,"honorific":"aaa","dedLine":1513671829193,"paymentTerm":"aaa","estimationLimit":"aaa","estimationMemo":"aaa","presentationDate":1513671829193,"publishEmployee":{"createdAt":1513673292974,"createdUser":"sid","updatedAt":1513672209170,"updatedUser":"sid","deletedAt":1513672209170,"deletedUser":"sid","version":0,"id":24902,"name":"担当　太郎","saCode":"SA001","ceName":"CE太郎","ceCode":"CE001","phoneNumber":"000-1111-1111","address":"神奈川県川崎市","faxNumber":"111-1111","postNumber":"111-1111","mailAddress":"aaa@ricoh.com","salesCompany":"川崎支店","affiliationName":"川崎事業所","departmentName":"第一営業部","supervisor":null,"employeeMaster":{"id":3,"name":"担当　太郎","saCode":"SA0001","phoneNumber":null,"address":null,"faxNumber":null,"postNumber":null,"mailAddress":null,"salesCompany":null,"affiliationName":null,"departmentName":null,"supervisorId":1,"department":{"id":1,"name":"川崎事業所","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"department":{"id":1,"name":"川崎事業所","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"attachedFiles":[]},"rank":"aaa","process":"aaa","competitor":"aaa","lostReason":"aaa","compeCompany":"aaa","compeStatus":"aaa","compePrice":1111,"addOnDeal":"aaa","addOnItem":"aaa","details":[{"createdAt":1513673292969,"createdUser":"sid","updatedAt":1513672209171,"updatedUser":"sid","deletedAt":1513672209171,"deletedUser":"sid","version":0,"id":12540,"item":{"createdAt":1513673292969,"createdUser":"sid","updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null,"version":0,"id":12540,"name":"中電-業務用電力","itemCode":"c-commPow_a","itemMaster":{"id":1,"name":"中電-業務用電力","itemCode":"c-commPow_a","product":{"id":1,"name":"電力","estimationExtendKeyList":[{"id":1,"name":"仕入元拠点ID","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},{"id":2,"name":"お客様識別番号","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},{"id":3,"name":"供給地点番号","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null}],"createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null}},"product":{"id":1,"name":"電力","estimationExtendKeyList":[{"id":1,"name":"仕入元拠点ID","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},{"id":2,"name":"お客様識別番号","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},{"id":3,"name":"供給地点番号","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null}],"createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null},"extendsParameter":"{\"proposal\":{\"createDate\":null,\"item\":{\"name\":null,\"hightPower\":false,\"scale\":null,\"type\":null,\"unitPrice\":null,\"co2Emissions\":null,\"totalUnitPrice\":0.0},\"ricohElectric\":{\"name\":null,\"presentedPrice\":null,\"partedPrice\":null,\"co2Emissions\":null,\"totalUnitPrice\":0.0,\"powerReserved\":null},\"electric\":0,\"powerRate\":0.0,\"electricCompanyPrice\":0.0,\"presentedPrice\":0.0,\"presentedDecrecedPrice\":0.0,\"presentedDecrecedRate\":0.0,\"partedRate\":0.0,\"grossProfit\":0.0,\"grossProfitRate\":0.0,\"ancillaryService\":false},\"usagePredication\":{\"presentationHistory\":{\"name\":null,\"usagePredicationPerMonths\":[{\"year\":null,\"month\":null,\"contractedPower\":0.0,\"consumptedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"currentPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"changedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"decreasePrice\":0.0,\"decreaseRate\":0.0,\"thisYearEarnings\":null,\"nextYearEarnings\":null}],\"totalUsagePredicationPerMonths\":{\"year\":null,\"month\":null,\"contractedPower\":0.0,\"consumptedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"currentPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"changedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"decreasePrice\":0.0,\"decreaseRate\":0.0,\"thisYearEarnings\":null,\"nextYearEarnings\":null},\"firstHalfTotalUsagePredicationPerMonths\":{\"year\":null,\"month\":null,\"contractedPower\":0.0,\"consumptedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"currentPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"changedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"decreasePrice\":0.0,\"decreaseRate\":0.0,\"thisYearEarnings\":null,\"nextYearEarnings\":null},\"secondHalfTotalUsagePredicationPerMonths\":{\"year\":null,\"month\":null,\"contractedPower\":0.0,\"consumptedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"currentPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"changedPower\":{\"basis\":0.0,\"summer\":0.0,\"otherSeason\":0.0,\"total\":0.0},\"decreasePrice\":0.0,\"decreaseRate\":0.0,\"thisYearEarnings\":null,\"nextYearEarnings\":null}}}}"}],"estimationUniqueDetail":[{"createdAt":1513673292967,"createdUser":"sid","updatedAt":null,"updatedUser":null,"deletedAt":1513671829193,"deletedUser":"aaa","version":0,"id":54946,"detail":"cotos002","extendKey":{"id":2,"name":"お客様識別番号","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null}},{"createdAt":1513673292967,"createdUser":"sid","updatedAt":null,"updatedUser":null,"deletedAt":1513671829193,"deletedUser":"aaa","version":0,"id":54947,"detail":"test003","extendKey":{"id":3,"name":"供給地点番号","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null}},{"createdAt":1513673292966,"createdUser":"sid","updatedAt":null,"updatedUser":null,"deletedAt":1513671829193,"deletedUser":"aaa","version":0,"id":54945,"detail":"cotos001","extendKey":{"id":1,"name":"仕入元拠点ID","createdAt":null,"createdUser":null,"updatedAt":null,"updatedUser":null,"deletedAt":null,"deletedUser":null}}],"extraParameter":"{\"key\":\"value\"}","estimationCreateDate":1513671829193,"attachedFiles":[]};
var sample2 = {
	"key1" : "AAA",
	"key2" : "BBB",
	"key3" : "CCC",
	"key4" : "DDD",
	"objectKey":{"objkey1":"obj1",
		      "objkey2":"obj2",
		      "objkey3":"obj3"
    },
	"listKey1":[{"listobjKey1":"1月","listobjKey2":"bbbb","listobjKey3":"cccc","listobjKey4":"dddd"},
		    {"listobjKey1":"2月","listobjKey2":"bbbb","listobjKey3":"cccc","listobjKey4":"dddd"},
		    {"listobjKey1":"3月","listobjKey2":"bbbb","listobjKey3":"cccc","listobjKey4":"dddd"},
		    {"listobjKey1":"4月","listobjKey2":"bbbb","listobjKey3":"cccc","listobjKey4":"dddd"},
		    {"listobjKey1":"5月","listobjKey2":"bbbb","listobjKey3":"cccc","listobjKey4":"dddd"}],
	"listKey2":[{"listCulumn1":"あああ","listCulumn2":"bbbb","listCulumn3":"cccc"},
		    {"listCulumn1":"いいい","listCulumn2":"bbbb","listCulumn3":"cccc"},
			{"listCulumn1":"ううう","listCulumn2":"bbbb","listCulumn3":"cccc"},
			{"listCulumn1":"えええ","listCulumn2":"bbbb","listCulumn3":"cccc"}],
	"listKey3":[]
};

/**
 * メイン処理
 * @returns
 */
$(function() {
	//$("#json-table").tabulator(header);
	//createHtml(sample1);
	//$('div.mainSub').append(createHtml(sample2));
	$('#create').click();
	$('#update').click();
});

/** --------------------------------- 表示制御　-----------------------------------*/
//htmlを作成するメソッドです。
function createHtml(json){
	//var header = "{\"layout\":\"fitColumns\",\"columns\":[";
	var data = "{";
	for (key in json) {
		if (Array.isArray(json[key])) { // 配列判定
			if(json[key].length > 0)
			  $("div.mainSub").append(addTableDiv(key));
			  createTableFromList(key, json[key]);
		}else if(isObject(json[key])) {// オブジェクト判定
			$("div.mainSub").append(addTableDiv(key));
			createTableFromObject(key, json[key]);
			//html += createHtml(json[key]);
		}else{
			data += addColumn(key, json[key]);
		}
	}
	$("div.mainSub").prepend(addTableDiv("test"));
	data = data.slice(0, -1) + "}";
	createTableFromObject("test", JSON.parse(data));
};

// 配列からtabulatorにより表生成するメソッド ※obujectのリストでないとダメ
function createTableFromList(tagId,　jsonArray) {
	var header = "{\"layout\":\"fitColumns\",\"columns\":[";
		for (key in jsonArray) {
			if (isObject(jsonArray[key])) {
				for (subKey in jsonArray[key]) {
					header += "{\"title\":\"" + subKey + "\",\"field\":\"" + subKey + "\"" + ",\"editor\":true},";
				}
			}
			header = header.slice(0, -1) + "]}";
			var parseHeader = JSON.parse(header);
			$("#" + tagId).tabulator(parseHeader); // tabulatarのヘッダー情報定義
			$("#" + tagId).tabulator("setData", jsonArray);　// tabulatarのデータ情報定義
			alert(header);
			break;
		}
}

//オブジェクトからtabulatorにより表生成するメソッド
function createTableFromObject(tagId, jsonObject){
	var header = "{\"layout\":\"fitColumns\",\"columns\":[";
	for (key in jsonObject) {
			header += "{\"title\":\"" + key + "\",\"field\":\"" + key + "\"" + ",\"editor\":true},";
	}
	header = header.slice(0, -1) + "]}";
	var parseHeader = JSON.parse(header);
	$("#" + tagId).tabulator(parseHeader); // tabulatarのヘッダー情報定義
	$("#" + tagId).tabulator("setData", changeList(JSON.stringify(jsonObject)));　// tabulatarのデータ情報定義
}



//タグを付加して1レコード作成するメソッド
function addColumn(key, column){ return "\"" + key + "\":\"" + column + "\","; };
// 表の表示用ブロック作成メソッド
function addTableDiv(key){ return '<h4>■'　+　key　+　'</h4><div id=' + key + '></div>'; };
//Object判定用メソッド
function isObject(o) {  return (o instanceof Object && !(o instanceof Array)) ? true : false;	};
//オブジェクトをリスト標識に変更
function changeList(jsonString) { return '[' + jsonString + ']'};

/** --------------------------------- 更新制御　-----------------------------------*/

function　OnButton(){
	var data = $("#listKey1").tabulator("getData");
	alert(JSON.stringify(data));
	}

function OnCreateTable(){
	$("div.mainSub").empty();
	var jsondata = $('#jsontext').val();
	//alert(jsondata);
	//alert(JSON.parse(jsondata));
	createHtml(JSON.parse(jsondata));
}



